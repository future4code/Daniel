<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Blog</title>
</head>
<style>
    main {
        display: grid;
        grid-template-columns: 1fr 1fr;
    }
</style>

<body>
    <header>
        <h1>Blog</h1>
    </header>
    <main>
        <section class="form">
            <label>Titulo do post</label>
            <input id="inputTitulo" type="text" placeholder="Titulo do post">
            <label>Autor</label>
            <input id="inputAutor" type="text" placeholder="Autor do post">
            <label>URL da Imagem</label>
            <input id="inputImagem" type="text" placeholder="Link da imagem">
            <label>Conte√∫do</label>
            <textarea id="inputPost" type="text" placeholder="..."></textarea>
            <button onclick="createPost()" id="send-post">Post IT!</button>
        </section>
        <section class="post-container">
        </section>
    </main>
</body>
<script>
    let todosPosts = buscaItem("posts");

    document.addEventListener("DOMContentLoaded", function () {
        loadAllPosts(todosPosts);
    });

    class Post {
        constructor(titulo, autor, post, urlDaImagem) {
            this.titulo = titulo;
            this.autor = autor;
            this.post = post;
            this.urlDaImagem = urlDaImagem;
        }
    }
    function buscaItem(chave) {
        const valor = window.localStorage.getItem(chave);
        if (valor) {
            return JSON.parse(valor);
        }
        return [];
    }
    function salvaItem(chave, item) {
        if (item && chave) {
            window.localStorage.setItem(chave, JSON.stringify(item));
        }
    }
    function limpaCampos() {
        const campos = document.querySelectorAll(".form input,.form textarea");
        for (let input of campos) {
            input.value = "";
        }
    }
    function createPost() {
        const titulo = document.querySelector("#inputTitulo");
        const autor = document.querySelector("#inputAutor");
        const imagem = document.querySelector("#inputImagem");
        const post = document.querySelector("#inputPost");

        const newPost = new Post(titulo.value, autor.value, post.value, imagem.value);

        todosPosts.push(newPost);
        salvaItem("posts",todosPosts);
        loadNewPost(todosPosts);
        limpaCampos();
    }

    function loadNewPost(posts) {
        const container = document.querySelector(".post-container");
        const tagTitulo = document.createElement("h2");
        const tagAutor = document.createElement("h3");
        const tagImagem = document.createElement("img");
        const tagPost = document.createElement("p");

        const newPost = posts[posts.length - 1];

        tagImagem.src = newPost.urlDaImagem;
        tagTitulo.innerHTML = newPost.titulo;
        tagAutor.innerHTML = newPost.autor;
        tagPost.innerHTML = newPost.post;

        container.append(tagTitulo, tagAutor, tagImagem, tagPost);

    }
    function loadAllPosts(posts) {
        for (let i = 0; i < posts.length; i++) {
            const container = document.querySelector(".post-container");
            const tagTitulo = document.createElement("h2");
            const tagAutor = document.createElement("h3");
            const tagImagem = document.createElement("img");
            const tagPost = document.createElement("p");

            const newPost = posts[i];
            console.log(newPost);

            tagImagem.src = newPost.urlDaImagem;
            tagTitulo.innerHTML = newPost.titulo;
            tagAutor.innerHTML = newPost.autor;
            tagPost.innerHTML = newPost.post;

            container.append(tagTitulo, tagAutor, tagImagem, tagPost);
        }
    }

</script>

</html>